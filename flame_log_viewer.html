<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Flame Graph Viewer</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style>
      svg {
        font-family: Arial, sans-serif;
        width: 100%;
      }
      .node {
        stroke: #fff;
      }
      .node:hover {
        stroke: #000;
      }
      .node-text {
        pointer-events: none;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <h1>Flame Graph Viewer</h1>
    <div id="flameGraphContainer"></div>
    <div
      id="tooltip"
      style="
        position: absolute;
        display: none;
        padding: 10px;
        background: #fff;
        border: 1px solid #ccc;
        pointer-events: none;
        z-index: 10;
      "
    ></div>

    <script>
      // DATA STARTS HERE
const data = [{"log_id": "4c262b02-dbab-4b33-bca8-2457c9e225c1", "function_name": "openai.chat.completions.create", "start_time": 1712804093.305824, "end_time": 1712804094.38918, "args": {"model": "gpt-3.5-turbo", "messages": [{"role": "system", "content": "You are a helpful assistant. Keep your answers as short as possible, don't make assumptions about what values to plug into functions. Ask for clarification if a user request is ambiguous."}, {"role": "user", "content": "news in delhi"}], "tools": [{"type": "function", "function": {"name": "get_last_n_arxiv_articles", "description": "Retrieves the last N articles from arXiv for a given query.", "parameters": {"type": "object", "properties": {"query": {"type": "string", "description": "The search query to find articles in arXiv."}, "n": {"type": "integer", "description": "The number of articles to retrieve."}}, "required": ["query", "n"]}}}, {"type": "function", "function": {"name": "get_latest_news", "description": "Retrieves the latest news articles based on a query", "parameters": {"type": "object", "properties": {"query": {"type": "string", "description": "The search query to find news articles."}, "summarize": {"type": "boolean", "description": "Instead of returning articles, summarizes all of them. Only set this to True if the user has explicitly mentioned to summarize."}, "n": {"type": "integer", "description": "The number of news articles to retrieve."}}, "required": ["query", "summarize", "n"]}}}]}, "result": {"id": "chatcmpl-9CesQK1JyWlMQrZwKxIgvQIeZhZlw", "choices": [{"finish_reason": "tool_calls", "index": 0, "logprobs": 'None', "message": {"content": 'None', "role": "assistant", "function_call": 'None', "tool_calls": [{"id": "call_HSWXDk3UfhiThoW4J4m66whF", "function": {"arguments": "{\"query\":\"news in Delhi\",\"n\":5,\"summarize\":false}", "name": "get_latest_news"}, "type": "function"}]}}], "created": 1712804094, "model": "gpt-3.5-turbo-0125", "object": "chat.completion", "system_fingerprint": "fp_b28b39ffa8", "usage": {"completion_tokens": 27, "prompt_tokens": 201, "total_tokens": 228}}, "task_id": "86ff1207-6717-453f-a2d7-84bca74237e3", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response"}, {"log_id": "5079a32b-c84e-4eda-849b-58e45cce7d6a", "function_name": "openai.chat.completions.create", "start_time": 1712804095.010106, "end_time": 1712804096.356938, "args": {"model": "gpt-3.5-turbo", "messages": [{"role": "system", "content": "Return a test json"}, {"role": "user", "content": "test json about weather"}]}, "result": {"id": "chatcmpl-9CesRvXh0qPTgYZAQjgkQuiLk0WIU", "choices": [{"finish_reason": "stop", "index": 0, "logprobs": 'None', "message": {"content": "{\n  \"location\": \"New York\",\n  \"current_weather\": {\n    \"temperature\": 65,\n    \"description\": \"Partly cloudy\",\n    \"humidity\": \"72%\",\n    \"wind_speed\": \"5 mph\"\n  },\n  \"forecast\": {\n    \"tomorrow\": {\n      \"temperature\": 70,\n      \"description\": \"Sunny\"\n    },\n    \"day_after_tomorrow\": {\n      \"temperature\": 75,\n      \"description\": \"Clear skies\"\n    }\n  }\n}", "role": "assistant", "function_call": 'None', "tool_calls": 'None'}}], "created": 1712804095, "model": "gpt-3.5-turbo-0125", "object": "chat.completion", "system_fingerprint": "fp_b28b39ffa8", "usage": {"completion_tokens": 106, "prompt_tokens": 19, "total_tokens": 125}}, "task_id": "86ff1207-6717-453f-a2d7-84bca74237e3", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response -> run_tool -> get_latest_news -> test_tool"}, {"log_id": "3185b3c1-15f2-49ce-865d-1a56f9556878", "function_name": "test_tool", "start_time": 1712804095.010002, "end_time": 1712804096.357066, "args": {}, "result": "{\n  \"location\": \"New York\",\n  \"current_weather\": {\n    \"temperature\": 65,\n    \"description\": \"Partly cloudy\",\n    \"humidity\": \"72%\",\n    \"wind_speed\": \"5 mph\"\n  },\n  \"forecast\": {\n    \"tomorrow\": {\n      \"temperature\": 70,\n      \"description\": \"Sunny\"\n    },\n    \"day_after_tomorrow\": {\n      \"temperature\": 75,\n      \"description\": \"Clear skies\"\n    }\n  }\n}", "task_id": "86ff1207-6717-453f-a2d7-84bca74237e3", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response -> run_tool -> get_latest_news"}, {"log_id": "222b797d-cf8b-44a6-8ef7-92cde770b113", "function_name": "get_latest_news", "start_time": 1712804094.389492, "end_time": 1712804096.359201, "args": {"args": {"query": "news in Delhi", "n": 5, "summarize": false}}, "result": "1. (BBC News) India and Pakistan trade barbs over targeted killings - Tensions stirred after a newspaper accused India of being involved in at least 20 extrajudicial killings in Pakistan.\n2. (Theregister.com) Vigorous US lobbying reportedly reversed India PC import license scheme - Washington was most displeased and New Delhi knew it made a mistake\nIndia was subjected to intense US lobbying after suddenly imposing a requirement that computer importers obtain a license, according to a news report on Thursday.\u2026\n3. (The Indian Express) Delhi News Live Updates: Kejriwal skips ED summons in Delhi Jal Board case - Delhi News Live Updates, March 18: The AAP claims that the DJB case \u201cseems to be a backup plan to arrest Kejriwal\u201d and \u201cstop him from campaigning for the Lok Sabha polls.\u201d\n4. (NPR) Indian judge says billion-dollar ayurvedic company has taken the public 'for a ride' - The country's supreme court has temporarily banned Patanjali, a leading maker of ayurvedic products with ties to the prime minister, from advertising certain items due to a history of false claims.\n5. (Al Jazeera English) Is India behind targeted killings in Pakistan? What we know - Pakistani officials tell Al Jazeera at least eight killings could be linked to India. New Delhi rejects these charges.", "task_id": "86ff1207-6717-453f-a2d7-84bca74237e3", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response -> run_tool"}, {"log_id": "12ad7729-9a5c-4c7a-9556-ccbf9068e10a", "function_name": "run_tool", "start_time": 1712804094.389395, "end_time": 1712804096.359234, "args": {"response": "ChatCompletion(id='chatcmpl-9CesQK1JyWlMQrZwKxIgvQIeZhZlw', choices=[Choice(finish_reason='tool_calls', index=0, logprobs=None, message=ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_HSWXDk3UfhiThoW4J4m66whF', function=Function(arguments='{\"query\":\"news in Delhi\",\"n\":5,\"summarize\":false}', name='get_latest_news'), type='function')]))], created=1712804094, model='gpt-3.5-turbo-0125', object='chat.completion', system_fingerprint='fp_b28b39ffa8', usage=CompletionUsage(completion_tokens=27, prompt_tokens=201, total_tokens=228))"}, "result": "1. (BBC News) India and Pakistan trade barbs over targeted killings - Tensions stirred after a newspaper accused India of being involved in at least 20 extrajudicial killings in Pakistan.\n2. (Theregister.com) Vigorous US lobbying reportedly reversed India PC import license scheme - Washington was most displeased and New Delhi knew it made a mistake\nIndia was subjected to intense US lobbying after suddenly imposing a requirement that computer importers obtain a license, according to a news report on Thursday.\u2026\n3. (The Indian Express) Delhi News Live Updates: Kejriwal skips ED summons in Delhi Jal Board case - Delhi News Live Updates, March 18: The AAP claims that the DJB case \u201cseems to be a backup plan to arrest Kejriwal\u201d and \u201cstop him from campaigning for the Lok Sabha polls.\u201d\n4. (NPR) Indian judge says billion-dollar ayurvedic company has taken the public 'for a ride' - The country's supreme court has temporarily banned Patanjali, a leading maker of ayurvedic products with ties to the prime minister, from advertising certain items due to a history of false claims.\n5. (Al Jazeera English) Is India behind targeted killings in Pakistan? What we know - Pakistani officials tell Al Jazeera at least eight killings could be linked to India. New Delhi rejects these charges.", "task_id": "86ff1207-6717-453f-a2d7-84bca74237e3", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response"}, {"log_id": "b14e230b-367e-472c-8b4f-137383f863b9", "function_name": "get_openai_assistant_response", "start_time": 1712804093.30178, "end_time": 1712804096.359282, "args": {"messages": [{"role": "user", "content": "news in delhi"}]}, "result": "1. (BBC News) India and Pakistan trade barbs over targeted killings - Tensions stirred after a newspaper accused India of being involved in at least 20 extrajudicial killings in Pakistan.\n2. (Theregister.com) Vigorous US lobbying reportedly reversed India PC import license scheme - Washington was most displeased and New Delhi knew it made a mistake\nIndia was subjected to intense US lobbying after suddenly imposing a requirement that computer importers obtain a license, according to a news report on Thursday.\u2026\n3. (The Indian Express) Delhi News Live Updates: Kejriwal skips ED summons in Delhi Jal Board case - Delhi News Live Updates, March 18: The AAP claims that the DJB case \u201cseems to be a backup plan to arrest Kejriwal\u201d and \u201cstop him from campaigning for the Lok Sabha polls.\u201d\n4. (NPR) Indian judge says billion-dollar ayurvedic company has taken the public 'for a ride' - The country's supreme court has temporarily banned Patanjali, a leading maker of ayurvedic products with ties to the prime minister, from advertising certain items due to a history of false claims.\n5. (Al Jazeera English) Is India behind targeted killings in Pakistan? What we know - Pakistani officials tell Al Jazeera at least eight killings could be linked to India. New Delhi rejects these charges.", "task_id": "86ff1207-6717-453f-a2d7-84bca74237e3", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": ""}, {"log_id": "1196f918-3e0d-406f-a04f-f7e73b6b01a7", "function_name": "openai.chat.completions.create", "start_time": 1712804109.979635, "end_time": 1712804111.540376, "args": {"model": "gpt-3.5-turbo", "messages": [{"role": "system", "content": "You are a helpful assistant. Keep your answers as short as possible, don't make assumptions about what values to plug into functions. Ask for clarification if a user request is ambiguous."}, {"role": "user", "content": "summarize news in delhi"}], "tools": [{"type": "function", "function": {"name": "get_last_n_arxiv_articles", "description": "Retrieves the last N articles from arXiv for a given query.", "parameters": {"type": "object", "properties": {"query": {"type": "string", "description": "The search query to find articles in arXiv."}, "n": {"type": "integer", "description": "The number of articles to retrieve."}}, "required": ["query", "n"]}}}, {"type": "function", "function": {"name": "get_latest_news", "description": "Retrieves the latest news articles based on a query", "parameters": {"type": "object", "properties": {"query": {"type": "string", "description": "The search query to find news articles."}, "summarize": {"type": "boolean", "description": "Instead of returning articles, summarizes all of them. Only set this to True if the user has explicitly mentioned to summarize."}, "n": {"type": "integer", "description": "The number of news articles to retrieve."}}, "required": ["query", "summarize", "n"]}}}]}, "result": {"id": "chatcmpl-9CesgFcqDQECRzuJH8pdc93WDksLJ", "choices": [{"finish_reason": "tool_calls", "index": 0, "logprobs": 'None', "message": {"content": 'None', "role": "assistant", "function_call": 'None', "tool_calls": [{"id": "call_1L8wEZyfQPCkQFeuj0QgBfkt", "function": {"arguments": "{\"query\":\"news in Delhi\",\"summarize\":true,\"n\":5}", "name": "get_latest_news"}, "type": "function"}]}}], "created": 1712804110, "model": "gpt-3.5-turbo-0125", "object": "chat.completion", "system_fingerprint": "fp_b28b39ffa8", "usage": {"completion_tokens": 27, "prompt_tokens": 204, "total_tokens": 231}}, "task_id": "3fbff8b2-3bbb-4fdd-894c-be349aaa8e49", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response"}, {"log_id": "55257253-47cb-496f-b6b4-02d8c00e4e30", "function_name": "openai.chat.completions.create", "start_time": 1712804111.824173, "end_time": 1712804112.932819, "args": {"model": "gpt-3.5-turbo", "messages": [{"role": "system", "content": "Return a test json"}, {"role": "user", "content": "test json about weather"}]}, "result": {"id": "chatcmpl-9CesixRT3pHbve4tEoyWiKqvMfwBz", "choices": [{"finish_reason": "stop", "index": 0, "logprobs": 'None', "message": {"content": "{\n    \"location\": \"New York City\",\n    \"weather\": \"Cloudy\",\n    \"temperature\": \"72\u00b0F\",\n    \"humidity\": \"60%\",\n    \"wind_speed\": \"10 mph\"\n}", "role": "assistant", "function_call": 'None', "tool_calls": 'None'}}], "created": 1712804112, "model": "gpt-3.5-turbo-0125", "object": "chat.completion", "system_fingerprint": "fp_b28b39ffa8", "usage": {"completion_tokens": 43, "prompt_tokens": 19, "total_tokens": 62}}, "task_id": "3fbff8b2-3bbb-4fdd-894c-be349aaa8e49", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response -> run_tool -> get_latest_news -> test_tool"}, {"log_id": "e9875e3d-0301-470a-b1b2-b8b7924e4f1c", "function_name": "test_tool", "start_time": 1712804111.824034, "end_time": 1712804112.932935, "args": {}, "result": "{\n    \"location\": \"New York City\",\n    \"weather\": \"Cloudy\",\n    \"temperature\": \"72\u00b0F\",\n    \"humidity\": \"60%\",\n    \"wind_speed\": \"10 mph\"\n}", "task_id": "3fbff8b2-3bbb-4fdd-894c-be349aaa8e49", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response -> run_tool -> get_latest_news"}, {"log_id": "0f07750b-edf3-4642-b676-75d09cdfb6a1", "function_name": "openai.chat.completions.create", "start_time": 1712804112.933007, "end_time": 1712804115.704621, "args": {"model": "gpt-3.5-turbo", "messages": [{"role": "system", "content": "You are an expert news summarizer. You cover the right topics for just the right time and give succint summaries of the news that the user provides. Give free form sentences no points."}, {"role": "user", "content": "1. (BBC News) India and Pakistan trade barbs over targeted killings - Tensions stirred after a newspaper accused India of being involved in at least 20 extrajudicial killings in Pakistan.\n2. (Theregister.com) Vigorous US lobbying reportedly reversed India PC import license scheme - Washington was most displeased and New Delhi knew it made a mistake\nIndia was subjected to intense US lobbying after suddenly imposing a requirement that computer importers obtain a license, according to a news report on Thursday.\u2026\n3. (The Indian Express) Delhi News Live Updates: Kejriwal skips ED summons in Delhi Jal Board case - Delhi News Live Updates, March 18: The AAP claims that the DJB case \u201cseems to be a backup plan to arrest Kejriwal\u201d and \u201cstop him from campaigning for the Lok Sabha polls.\u201d\n4. (NPR) Indian judge says billion-dollar ayurvedic company has taken the public 'for a ride' - The country's supreme court has temporarily banned Patanjali, a leading maker of ayurvedic products with ties to the prime minister, from advertising certain items due to a history of false claims.\n5. (Al Jazeera English) Is India behind targeted killings in Pakistan? What we know - Pakistani officials tell Al Jazeera at least eight killings could be linked to India. New Delhi rejects these charges.\n"}]}, "result": {"id": "chatcmpl-9CesjbyNyjOeum7kMLOVDadQ0R1ZE", "choices": [{"finish_reason": "stop", "index": 0, "logprobs": 'None', "message": {"content": "India and Pakistan are at odds over targeted killings, with accusations flying from both sides. Tensions escalated after reports of extrajudicial killings and allegations of involvement by India. The US reportedly applied strong lobbying pressure on India regarding a PC import license scheme, causing friction between the two countries. In Delhi, Chief Minister Kejriwal skipped an ED summons related to the Delhi Jal Board case, with the AAP claiming it as a move to hinder his election campaign. The Indian Supreme Court has put a temporary ban on advertising for Patanjali, a major ayurvedic products company, due to past false claims. Pakistani officials suggest India may be linked to targeted killings in their country, with New Delhi denying any involvement.", "role": "assistant", "function_call": 'None', "tool_calls": 'None'}}], "created": 1712804113, "model": "gpt-3.5-turbo-0125", "object": "chat.completion", "system_fingerprint": "fp_b28b39ffa8", "usage": {"completion_tokens": 144, "prompt_tokens": 325, "total_tokens": 469}}, "task_id": "3fbff8b2-3bbb-4fdd-894c-be349aaa8e49", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response -> run_tool -> get_latest_news"}, {"log_id": "c58ce4c9-aa78-4441-846c-b90bc3465ea1", "function_name": "get_latest_news", "start_time": 1712804111.542244, "end_time": 1712804115.71168, "args": {"args": {"query": "news in Delhi", "summarize": true, "n": 5}}, "result": "India and Pakistan are at odds over targeted killings, with accusations flying from both sides. Tensions escalated after reports of extrajudicial killings and allegations of involvement by India. The US reportedly applied strong lobbying pressure on India regarding a PC import license scheme, causing friction between the two countries. In Delhi, Chief Minister Kejriwal skipped an ED summons related to the Delhi Jal Board case, with the AAP claiming it as a move to hinder his election campaign. The Indian Supreme Court has put a temporary ban on advertising for Patanjali, a major ayurvedic products company, due to past false claims. Pakistani officials suggest India may be linked to targeted killings in their country, with New Delhi denying any involvement.", "task_id": "3fbff8b2-3bbb-4fdd-894c-be349aaa8e49", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response -> run_tool"}, {"log_id": "265aa6dc-ffe5-4cbb-a71d-476c7903ad14", "function_name": "run_tool", "start_time": 1712804111.541863, "end_time": 1712804115.711789, "args": {"response": "ChatCompletion(id='chatcmpl-9CesgFcqDQECRzuJH8pdc93WDksLJ', choices=[Choice(finish_reason='tool_calls', index=0, logprobs=None, message=ChatCompletionMessage(content=None, role='assistant', function_call=None, tool_calls=[ChatCompletionMessageToolCall(id='call_1L8wEZyfQPCkQFeuj0QgBfkt', function=Function(arguments='{\"query\":\"news in Delhi\",\"summarize\":true,\"n\":5}', name='get_latest_news'), type='function')]))], created=1712804110, model='gpt-3.5-turbo-0125', object='chat.completion', system_fingerprint='fp_b28b39ffa8', usage=CompletionUsage(completion_tokens=27, prompt_tokens=204, total_tokens=231))"}, "result": "India and Pakistan are at odds over targeted killings, with accusations flying from both sides. Tensions escalated after reports of extrajudicial killings and allegations of involvement by India. The US reportedly applied strong lobbying pressure on India regarding a PC import license scheme, causing friction between the two countries. In Delhi, Chief Minister Kejriwal skipped an ED summons related to the Delhi Jal Board case, with the AAP claiming it as a move to hinder his election campaign. The Indian Supreme Court has put a temporary ban on advertising for Patanjali, a major ayurvedic products company, due to past false claims. Pakistani officials suggest India may be linked to targeted killings in their country, with New Delhi denying any involvement.", "task_id": "3fbff8b2-3bbb-4fdd-894c-be349aaa8e49", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": "get_openai_assistant_response"}, {"log_id": "3949116c-70f0-483e-9bca-7d21a2c11105", "function_name": "get_openai_assistant_response", "start_time": 1712804109.979458, "end_time": 1712804115.711882, "args": {"messages": [{"role": "user", "content": "summarize news in delhi"}]}, "result": "India and Pakistan are at odds over targeted killings, with accusations flying from both sides. Tensions escalated after reports of extrajudicial killings and allegations of involvement by India. The US reportedly applied strong lobbying pressure on India regarding a PC import license scheme, causing friction between the two countries. In Delhi, Chief Minister Kejriwal skipped an ED summons related to the Delhi Jal Board case, with the AAP claiming it as a move to hinder his election campaign. The Indian Supreme Court has put a temporary ban on advertising for Patanjali, a major ayurvedic products company, due to past false claims. Pakistani officials suggest India may be linked to targeted killings in their country, with New Delhi denying any involvement.", "task_id": "3fbff8b2-3bbb-4fdd-894c-be349aaa8e49", "agent_id": "18bd03a1-295c-4cd0-b458-2b65c6e6bf70", "call_stack": ""}, {"log_id": "655b57cb-f0b3-451d-befa-8b55a7aa6866", "function_name": "openai.chat.completions.create", "start_time": 1712804142.37807, "end_time": 1712804143.574831, "args": {"model": "gpt-3.5-turbo", "messages": [{"role": "system", "content": "You are a helpful assistant. Keep your answers as short as possible, don't make assumptions about what values to plug into functions. Ask for clarification if a user request is ambiguous."}, {"role": "user", "content": "news in delhi"}], "tools": [{"type": "function", "function": {"name": "get_last_n_arxiv_articles", "description": "Retrieves the last N articles from arXiv for a given query.", "parameters": {"type": "object", "properties": {"query": {"type": "string", "description": "The search query to find articles in arXiv."}, "n": {"type": "integer", "description": "The number of articles to retrieve."}}, "required": ["query", "n"]}}}, {"type": "function", "function": {"name": "get_latest_news", "description": "Retrieves the latest news articles based on a query", "parameters": {"type": "object", "properties": {"query": {"type": "string", "description": "The search query to find news articles."}, "summarize": {"type": "boolean", "description": "Instead of returning articles, summarizes all of them. Only set this to True if the user has explicitly mentioned to summarize."}, "n": {"type": "integer", "description": "The number of news articles to retrieve."}}, "required": ["query", "summarize", "n"]}}}]}, "result": {"id": "chatcmpl-9CetDHtFA2u3fO3iNzW0RMGmmvayw", "choices": [{"finish_reason": "tool_calls", "index": 0, "logprobs": 'None', "message": {"content": 'None', "role": "assistant", "function_call": 'None', "tool_calls": [{"id": "call_t6HZKDkf34DusYLCdqKZRwDu", "function": {"arguments": "{\"query\":\"Delhi\",\"n\":5,\"summarize\":false}", "name": "get_latest_news"}, "type": "function"}]}}], "created": 1712804143, "model": "gpt-3.5-turbo-0125", "object": "chat.completion", "system_fingerprint": "fp_c2295e73ad", "usage": {"completion_tokens": 26, "prompt_tokens": 201, "total_tokens": 227}}, "task_id": "88cba741-2724-48c5-8b65-783a93fca56c", "agent_id": "d64cbcb9-4403-4499-9f1c-ed8bd3c421aa", "call_stack": "get_openai_assistant_response"}, {"log_id": "37a40a14-a673-4c23-a544-a235c092432b", "function_name": "openai.chat.completions.create", "start_time": 1712804143.831523, "end_time": 1712804145.475805, "args": {"model": "gpt-3.5-turbo", "messages": [{"role": "system", "content": "Return a test json"}, {"role": "user", "content": "test json about weather"}]}, "result": {"id": "chatcmpl-9CetEU0HprlEpVq44fVggteIJZZe1", "choices": [{"finish_reason": "stop", "index": 0, "logprobs": 'None', "message": {"content": "{\n  \"city\": \"New York\",\n  \"country\": \"USA\",\n  \"weather\": {\n    \"temperature\": \"22\u00b0C\",\n    \"humidity\": \"65%\",\n    \"description\": \"Partly cloudy\"\n  },\n  \"wind\": {\n    \"speed\": \"10 km/h\",\n    \"direction\": \"NE\"\n  }\n}", "role": "assistant", "function_call": 'None', "tool_calls": 'None'}}], "created": 1712804144, "model": "gpt-3.5-turbo-0125", "object": "chat.completion", "system_fingerprint": "fp_b28b39ffa8", "usage": {"completion_tokens": 71, "prompt_tokens": 19, "total_tokens": 90}}, "task_id": "88cba741-2724-48c5-8b65-783a93fca56c", "agent_id": "d64cbcb9-4403-4499-9f1c-ed8bd3c421aa", "call_stack": "get_openai_assistant_response -> get_latest_news -> test_tool"}, {"log_id": "75817f40-4e75-4fd4-b5b5-eee165699704", "function_name": "test_tool", "start_time": 1712804143.831445, "end_time": 1712804145.476063, "args": {}, "result": "{\n  \"city\": \"New York\",\n  \"country\": \"USA\",\n  \"weather\": {\n    \"temperature\": \"22\u00b0C\",\n    \"humidity\": \"65%\",\n    \"description\": \"Partly cloudy\"\n  },\n  \"wind\": {\n    \"speed\": \"10 km/h\",\n    \"direction\": \"NE\"\n  }\n}", "task_id": "88cba741-2724-48c5-8b65-783a93fca56c", "agent_id": "d64cbcb9-4403-4499-9f1c-ed8bd3c421aa", "call_stack": "get_openai_assistant_response -> get_latest_news"}, {"log_id": "54a9ef5d-e6e7-494b-bfd4-ea1d6c95858c", "function_name": "get_latest_news", "start_time": 1712804143.575734, "end_time": 1712804145.483972, "args": {"args": {"query": "Delhi", "n": 5, "summarize": false}}, "result": "1. (BBC News) India and Pakistan trade barbs over targeted killings - Tensions stirred after a newspaper accused India of being involved in at least 20 extrajudicial killings in Pakistan.\n2. (BBC News) Delhi world's 'most polluted' capital city: report - India, of which Delhi is the capital, was also ranked as the third-most polluted country in the world.\n3. (BBC News) Opposition condemn arrest of Delhi chief minister - Arvind Kejriwal's arrest comes as a blow to the opposition just weeks before India's general elections.\n4. (Yahoo Entertainment) Exclusive-India 'screwed up': How the U.S. lobbied New Delhi to reverse laptop rules - India reversed a laptop licensing policy after behind-the-scenes lobbying by U.S. officials, who however remain concerned about New Delhi's compliance with...\n5. (BBC News) US urges fair legal process for India opposition leader - Washington reiterated its remark hours after Delhi summoned a US diplomat over similar comments.", "task_id": "88cba741-2724-48c5-8b65-783a93fca56c", "agent_id": "d64cbcb9-4403-4499-9f1c-ed8bd3c421aa", "call_stack": "get_openai_assistant_response"}, {"log_id": "09d91a3d-c584-4980-9938-b2974be17bb0", "function_name": "get_openai_assistant_response", "start_time": 1712804142.377524, "end_time": 1712804145.484222, "args": {"messages": [{"role": "user", "content": "news in delhi"}]}, "result": "1. (BBC News) India and Pakistan trade barbs over targeted killings - Tensions stirred after a newspaper accused India of being involved in at least 20 extrajudicial killings in Pakistan.\n2. (BBC News) Delhi world's 'most polluted' capital city: report - India, of which Delhi is the capital, was also ranked as the third-most polluted country in the world.\n3. (BBC News) Opposition condemn arrest of Delhi chief minister - Arvind Kejriwal's arrest comes as a blow to the opposition just weeks before India's general elections.\n4. (Yahoo Entertainment) Exclusive-India 'screwed up': How the U.S. lobbied New Delhi to reverse laptop rules - India reversed a laptop licensing policy after behind-the-scenes lobbying by U.S. officials, who however remain concerned about New Delhi's compliance with...\n5. (BBC News) US urges fair legal process for India opposition leader - Washington reiterated its remark hours after Delhi summoned a US diplomat over similar comments.", "task_id": "88cba741-2724-48c5-8b65-783a93fca56c", "agent_id": "d64cbcb9-4403-4499-9f1c-ed8bd3c421aa", "call_stack": ""}];
      // DATA ENDS HERE

      // Function to create a flame graph for each task
      function createFlameGraph(taskData, container) {
        // Set dimensions and margins for the graph
        const margin = { top: 20, right: 30, bottom: 30, left: 40 };
        const width = 900 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        // Create an SVG for the flame graph
        const svg = container
          .append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .append("g")
          .attr("transform", `translate(${margin.left},${margin.top})`);

        // Scales for the x and y axes
        const x = d3.scaleLinear().range([0, width]);
        const y = d3.scaleBand().range([0, height]).padding(0.1);

        // Set the domains for the scales
        x.domain([0, taskData.duration]);
        y.domain(taskData.children.map((d) => d.name));

        // Add the rectangles for the flame graph
        svg
          .selectAll("rect")
          .data(taskData.children)
          .enter()
          .append("rect")
          .attr("x", (d) => x(d.start))
          .attr("width", (d) => x(d.end - d.start))
          .attr("y", (d) => y(d.name))
          .attr("height", y.bandwidth())
          .attr("fill", "steelblue")
          .attr("class", "node")
          .attr(
            "title",
            (d) =>
              `${d.name}\nDuration: ${(d.end - d.start).toFixed(2)} seconds`
          );

        // Add the text labels
        svg
          .selectAll("text")
          .data(taskData.children)
          .enter()
          .append("text")
          .attr("x", (d) => x(d.start) + 3)
          .attr("y", (d) => y(d.name) + y.bandwidth() / 2)
          .attr("dy", "0.35em")
          .attr("class", "node-text")
          .text((d) => d.name);
      }

      // Function to build the hierarchy of tasks
      function buildHierarchy(logs) {
        logs.sort(function (a, b) {
          return parseFloat(a.start_time) - parseFloat(b.start_time);
        });

        const tasks = {};

        // Group logs by task_id
        logs.forEach((log) => {
          const taskId = log.task_id;
          if (!tasks[taskId]) {
            tasks[taskId] = {
              id: taskId,
              children: [],
              start: Infinity,
              end: -Infinity,
            };
          }

          const task = tasks[taskId];
          task.children.push({
            name: log.function_name,
            start: log.start_time,
            end: log.end_time,
          });

          task.start = Math.min(task.start, log.start_time);
          task.end = Math.max(task.end, log.end_time);
        });

        // Calculate the duration and normalize the start and end times for each task
        Object.values(tasks).forEach((task) => {
          task.duration = task.end - task.start;
          task.children.forEach((child) => {
            child.start -= task.start;
            child.end -= task.start;
          });
        });

        return tasks;
      }

      // Parse the log data into a hierarchical structure
      const tasks = buildHierarchy(logs);

      // Select the container for the flame graphs
      const container = d3.select("#flameGraphContainer");

      // Create a flame graph for each task
      Object.values(tasks).forEach((taskData) => {
        container.append("h2").text(`Task ID: ${taskData.id}`);
        createFlameGraph(taskData, container);
      });
    </script>
  </body>
</html>
